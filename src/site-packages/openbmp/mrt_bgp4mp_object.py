# -*- coding: utf-8 -*-
"""OpenBMP MRT

  Copyright (c) 2013-2016 Cisco Systems, Inc. and others.  All rights reserved.
  This program and the accompanying materials are made available under the
  terms of the Eclipse Public License v1.0 which accompanies this distribution,
  and is available at http://www.eclipse.org/legal/epl-v10.html

  .. moduleauthor:: Tim Evens <tievens@cisco.com>
"""
import multiprocessing
import socket
import kafka
import kafka.common
import copy
import time
import re


from openbmp.logger import init_mp_logger
from openbmp.parsed.headers import headers as parsed_headers
from openbmp.parsed.collector import collector
from openbmp.parsed.router import router


class MrtBgpMpObject(object):
    """ MRT BGP4MP message object used as queueing message """
    #: BMP Message Data - Does not include the BMP headers
    BMP_DATA = None

    #: Peer Key - Key used to uniquely reference this peer by collector and router
    PEER_KEY = None

    #: Collector Admin ID - May not always be set
    COLLECTOR_ADMIN_ID = ""

    #: Collector hash ID
    COLLECTOR_HASH_ID = ""

    #: Router IP
    ROUTER_IP = ""

    #: Router Name - May not always be set
    ROUTER_NAME = ""

    #: Peer RD
    PEER_RD = ""

    #: Peer IP Address
    PEER_ADDR = ""

    #: Peer ASN
    PEER_ASN = None

    #: Peer ASN Length
    PEER_ASN_LENGTH = 0

    #: Peer BGP-ID
    PEER_BGP_ID = None

    #: Local IP Address
    LOCAL_ADDR = None

    #: Local ASN
    LOCAL_ASN = 0

    #: Timestamp in seconds for the message
    TIMESTAMP_SEC = 0

    #: Timestamp microseconds
    TIMESTAMP_USEC = 0